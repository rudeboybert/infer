<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tidy ANOVA (Analysis of Variance) with infer • infer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy ANOVA (Analysis of Variance) with infer">
<meta name="description" content="Conducting ANOVA (Analysis of Variance) on tidy data with infer.">
<meta property="og:description" content="Conducting ANOVA (Analysis of Variance) on tidy data with infer.">
<meta property="og:image" content="https://infer.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<script defer data-domain="infer.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">infer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/infer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/t_test.html">Tidy t-Tests with infer</a></li>
    <li><a class="dropdown-item" href="../articles/anova.html">Tidy ANOVA (Analysis of Variance) with infer</a></li>
    <li><a class="dropdown-item" href="../articles/chi_squared.html">Tidy Chi-Squared Tests with infer</a></li>
    <li><a class="dropdown-item" href="../articles/paired.html">Tidy inference for paired data</a></li>
    <li><a class="dropdown-item" href="../articles/observed_stat_examples.html">Full infer Pipeline Examples</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/infer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidy ANOVA (Analysis of Variance) with infer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/infer/blob/main/vignettes/anova.Rmd" class="external-link"><code>vignettes/anova.Rmd</code></a></small>
      <div class="d-none name"><code>anova.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we’ll walk through conducting an analysis of
variance (ANOVA) test using infer. ANOVAs are used to analyze
differences in group means.</p>
<p>Throughout this vignette, we’ll make use of the <code>gss</code>
dataset supplied by infer, which contains a sample of data from the
General Social Survey. See <code><a href="../reference/gss.html">?gss</a></code> for more information on the
variables included and their source. Note that this data (and our
examples on it) are for demonstration purposes only, and will not
necessarily provide accurate estimates unless weighted properly. For
these examples, let’s suppose that this dataset is a representative
sample of a population we want to learn about: American adults. The data
looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">gss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 500</span></span>
<span><span class="co">## Columns: 11</span></span>
<span><span class="co">## $ year    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2014, 1994, 1998, 1996, 1994, 1996, 1990, 2016, 2000, 19…</span></span>
<span><span class="co">## $ age     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 36, 34, 24, 42, 31, 32, 48, 36, 30, 33, 21, 30, 38, 49, …</span></span>
<span><span class="co">## $ sex     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> male, female, male, male, male, female, female, female, …</span></span>
<span><span class="co">## $ college <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> degree, no degree, degree, no degree, degree, no degree,…</span></span>
<span><span class="co">## $ partyid <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> ind, rep, ind, ind, rep, rep, dem, ind, rep, dem, dem, i…</span></span>
<span><span class="co">## $ hompop  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3, 4, 1, 4, 2, 4, 2, 1, 5, 2, 4, 3, 4, 4, 2, 2, 3, 2, 1,…</span></span>
<span><span class="co">## $ hours   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50, 31, 40, 40, 40, 53, 32, 20, 40, 40, 23, 52, 38, 72, …</span></span>
<span><span class="co">## $ income  <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> $25000 or more, $20000 - 24999, $25000 or more, $25000 o…</span></span>
<span><span class="co">## $ class   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> middle class, working class, working class, working clas…</span></span>
<span><span class="co">## $ finrela <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> below average, below average, below average, above avera…</span></span>
<span><span class="co">## $ weight  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8960, 1.0825, 0.5501, 1.0864, 1.0825, 1.0864, 1.0627, …</span></span></code></pre>
<p>To carry out an ANOVA, we’ll examine the association between age and
political party affiliation in the United States. The <code>age</code>
variable is a numerical variable measuring the respondents’ age at the
time that the survey was taken, and <code>partyid</code> is a factor
variable with unique values ind, rep, dem, other.</p>
<p>This is what the relationship looks like in the observed data:</p>
<p><img src="anova_files/figure-html/plot-f-1.png" width="576"></p>
<p>If there were no relationship, we would expect to see the each of
these boxplots lining up along the y-axis. It looks like the average age
of democrats and republicans seems to be a bit larger than independent
and other American voters. Is this difference just random noise,
though?</p>
<p>First, to calculate the observed statistic, we can use
<code><a href="../reference/specify.html">specify()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the observed statistic</span></span>
<span><span class="va">observed_f_statistic</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">partyid</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span></code></pre></div>
<p>The observed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
statistic is 2.4842. Now, we want to compare this statistic to a null
distribution, generated under the assumption that age and political
party affiliation are not actually related, to get a sense of how likely
it would be for us to see this observed statistic if there were actually
no association between the two variables.</p>
<p>We can <code><a href="../reference/generate.html">generate()</a></code> an approximation of the null
distribution using randomization. The randomization approach permutes
the response and explanatory variables, so that each person’s party
affiliation is matched up with a random age from the sample in order to
break up any association between the two.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the null distribution using randomization</span></span>
<span><span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">partyid</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"permute"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span></code></pre></div>
<p>Note that, in the line <code>specify(age ~ partyid)</code> above, we
could use the equivalent syntax
<code>specify(response = age, explanatory = partyid)</code>.</p>
<p>To get a sense for what this distribution looks like, and where our
observed statistic falls, we can use <code><a href="../reference/visualize.html">visualize()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the null distribution and test statistic!</span></span>
<span><span class="va">null_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_f_statistic</span>,</span>
<span>                direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<p><img src="anova_files/figure-html/visualize-f-1.png" width="576"></p>
<p>We could also visualize the observed statistic against the
theoretical null distribution. To do so, use the <code><a href="../reference/assume.html">assume()</a></code>
verb to define a theoretical null distribution and then pass it to
<code><a href="../reference/visualize.html">visualize()</a></code> like a null distribution outputted from
<code><a href="../reference/generate.html">generate()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the theoretical null distribution and test statistic!</span></span>
<span><span class="va">null_dist_theory</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">partyid</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/assume.html">assume</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_dist_theory</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_f_statistic</span>,</span>
<span>                direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<p><img src="anova_files/figure-html/visualize-f-theor-1.png" width="576"></p>
<p>To visualize both the randomization-based and theoretical null
distributions to get a sense of how the two relate, we can pipe the
randomization-based null distribution into <code><a href="../reference/visualize.html">visualize()</a></code>, and
then further provide <code>method = "both"</code> to
<code><a href="../reference/visualize.html">visualize()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize both null distributions and the test statistic!</span></span>
<span><span class="va">null_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_f_statistic</span>,</span>
<span>                direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<p><img src="anova_files/figure-html/visualize-indep-both-1.png" width="576"></p>
<p>Either way, it looks like our observed test statistic would be quite
unlikely if there were actually no association between age and political
party affiliation. More exactly, we can approximate the p-value from the
randomization-based approximation to the null distribution:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the p value from the observed statistic and null distribution</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="va">null_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">observed_f_statistic</span>,</span>
<span>              direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_value</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">##   p_value</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   0.051</span></span></code></pre>
<p>Thus, if there were really no relationship between age and political
party affiliation, our approximation of the probability that we would
see a statistic as or more extreme than 2.4842 is approximately
0.051.</p>
<p>To calculate the p-value using the true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
distribution, we can use the <code><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf()</a></code> function from base R.
This function allows us to situate the test statistic we calculated
previously in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
distribution with the appropriate degrees of freedom.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">observed_f_statistic</span><span class="op">$</span><span class="va">stat</span>, <span class="fl">3</span>, <span class="fl">496</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.06006</span></span></code></pre>
<p>Note that, while the observed statistic stays the same, the resulting
p-value differs slightly between these two approaches since the
randomization-based empirical
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
distribution is an approximation of the true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>
distribution.</p>
<p>The package currently does not supply a wrapper for tidy ANOVA
tests.</p>
  </main>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Andrew Bray, Chester Ismay, Evgeni Chasnovski, Simon Couch, Ben Baumer, Mine Cetinkaya-Rundel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

  </div></footer>
</body>
</html>
