<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Conducting tests for paired independence on tidy data with infer.">
<title>Tidy inference for paired data • infer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tidy inference for paired data">
<meta property="og:description" content="Conducting tests for paired independence on tidy data with infer.">
<meta property="og:image" content="https://infer.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="infer.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">infer</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.6.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/infer.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/t_test.html">Tidy t-Tests with infer</a>
    <a class="dropdown-item" href="../articles/anova.html">Tidy ANOVA (Analysis of Variance) with infer</a>
    <a class="dropdown-item" href="../articles/chi_squared.html">Tidy Chi-Squared Tests with infer</a>
    <a class="dropdown-item" href="../articles/paired.html">Tidy inference for paired data</a>
    <a class="dropdown-item" href="../articles/observed_stat_examples.html">Full infer Pipeline Examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidymodels/infer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidy inference for paired data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/infer/blob/HEAD/vignettes/paired.Rmd" class="external-link"><code>vignettes/paired.Rmd</code></a></small>
      <div class="d-none name"><code>paired.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>In this vignette, we’ll walk through conducting a randomization-based
paired test of independence with infer.</p>
<p>Throughout this vignette, we’ll make use of the <code>gss</code>
dataset supplied by <code>infer</code>, which contains a sample of data
from the General Social Survey. See <code><a href="../reference/gss.html">?gss</a></code> for more
information on the variables included and their source. Note that this
data (and our examples on it) are for demonstration purposes only, and
will not necessarily provide accurate estimates unless weighted
properly. For these examples, let’s suppose that this dataset is a
representative sample of a population we want to learn about: American
adults. The data looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">gss</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 500</span></span>
<span><span class="co">## Columns: 11</span></span>
<span><span class="co">## $ year    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2014, 1994, 1998, 1996, 1994, 1996, 1990, 2016, 2000, 19…</span></span>
<span><span class="co">## $ age     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 36, 34, 24, 42, 31, 32, 48, 36, 30, 33, 21, 30, 38, 49, …</span></span>
<span><span class="co">## $ sex     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> male, female, male, male, male, female, female, female, …</span></span>
<span><span class="co">## $ college <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> degree, no degree, degree, no degree, degree, no degree,…</span></span>
<span><span class="co">## $ partyid <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> ind, rep, ind, ind, rep, rep, dem, ind, rep, dem, dem, i…</span></span>
<span><span class="co">## $ hompop  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3, 4, 1, 4, 2, 4, 2, 1, 5, 2, 4, 3, 4, 4, 2, 2, 3, 2, 1,…</span></span>
<span><span class="co">## $ hours   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 50, 31, 40, 40, 40, 53, 32, 20, 40, 40, 23, 52, 38, 72, …</span></span>
<span><span class="co">## $ income  <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> $25000 or more, $20000 - 24999, $25000 or more, $25000 o…</span></span>
<span><span class="co">## $ class   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> middle class, working class, working class, working clas…</span></span>
<span><span class="co">## $ finrela <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> below average, below average, below average, above avera…</span></span>
<span><span class="co">## $ weight  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8960, 1.0825, 0.5501, 1.0864, 1.0825, 1.0864, 1.0627, …</span></span></code></pre>
<p>Two sets of observations are paired if each observation in one column
has a special correspondence or connection with exactly one observation
in the other. For the purposes of this vignette, we’ll simulate an
additional data variable with a natural pairing: suppose that each of
these survey respondents had provided the number of <code>hours</code>
worked per week when surveyed 5 years prior, encoded as
<code>hours_previous</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gss_paired</span> <span class="op">&lt;-</span> <span class="va">gss</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      hours_previous <span class="op">=</span> <span class="va">hours</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="fl">4.8</span><span class="op">)</span>,</span>
<span>      diff <span class="op">=</span> <span class="va">hours</span> <span class="op">-</span> <span class="va">hours_previous</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="va">gss_paired</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">hours</span>, <span class="va">hours_previous</span>, <span class="va">diff</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 500 × 3</span></span></span>
<span><span class="co">##    hours hours_previous  diff</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>    50             52    -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>    31             32    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>    40             40     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>    40             37     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>    40             42    -<span style="color: #BB0000;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>    53             50     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>    32             28     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>    20             19     1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>    40             40     0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>    40             43    -<span style="color: #BB0000;">3</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 490 more rows</span></span></span></code></pre>
<p>The number of <code>hours</code> worked per week by a particular
respondent has a special correspondence with the number of hours worked
5 years prior <code>hours_previous</code> by that same respondent. We’d
like to test the null hypothesis that the <code>"mean"</code> hours
worked per week did not change between the sampled time and five years
prior.</p>
<p>To carry out inference on paired data with infer, we pre-compute the
difference between paired values at the beginning of the analysis, and
use those differences as our values of interest.</p>
<p>Here, we pre-compute the difference between paired observations as
<code>diff</code>. The distribution of <code>diff</code> in the observed
data looks like this:</p>
<p><img src="paired_files/figure-html/plot-diff-1.png" width="576"></p>
<p>From the looks of the distribution, most respondents worked a similar
number of hours worked per week as they had 5 hours prior, though it
seems like there may be a slight decline of number of hours worked per
week in aggregate. (We know that the true effect is -.2 since we’ve
simulated this data.)</p>
<p>We calculate the observed statistic in the paired setting in the same
way that we would outside of the paired setting. Using
<code><a href="../reference/specify.html">specify()</a></code> and <code><a href="../reference/calculate.html">calculate()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the observed statistic</span></span>
<span><span class="va">observed_statistic</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">gss_paired</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
<p>The observed statistic is -0.202. Now, we want to compare this
statistic to a null distribution, generated under the assumption that
the true difference was actually zero, to get a sense of how likely it
would be for us to see this observed difference if there were truly no
change in hours worked per week in the population.</p>
<p>Tests for paired data are carried out via the
<code>null = "paired independence"</code> argument to
<code><a href="../reference/hypothesize.html">hypothesize()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the null distribution</span></span>
<span><span class="va">null_dist</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">gss_paired</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"paired independence"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"permute"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span>   </span>
<span><span class="va">null_dist</span></span></code></pre></div>
<pre><code><span><span class="co">## Response: diff (numeric)</span></span>
<span><span class="co">## Null Hypothesis: paired independence</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 1,000 × 2</span></span></span>
<span><span class="co">##    replicate   stat</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>         1 -<span style="color: #BB0000;">0.146</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>         2  0.19 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>         3  0.042</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>         4  0.034</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>         5 -<span style="color: #BB0000;">0.138</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>         6 -<span style="color: #BB0000;">0.03</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>         7  0.174</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>         8  0.066</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>         9  0.01 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>        10  0.13 </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 990 more rows</span></span></span></code></pre>
<p>For each replicate, <code><a href="../reference/generate.html">generate()</a></code> carries out
<code>type = "permute"</code> with
<code>null = "paired independence"</code> by:</p>
<ul>
<li>Randomly sampling a vector of signs (i.e. -1 or 1), probability .5
for either, with length equal to the input data, and</li>
<li>Multiplying the response variable by the vector of signs, “flipping”
the observed values for a random subset of value in each replicate</li>
</ul>
<p>To get a sense for what this distribution looks like, and where our
observed statistic falls, we can use <code><a href="../reference/visualize.html">visualize()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the null distribution and test statistic</span></span>
<span><span class="va">null_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">observed_statistic</span>,</span>
<span>                direction <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span></span></code></pre></div>
<p><img src="paired_files/figure-html/visualize-1.png" width="576"></p>
<p>It looks like our observed mean of -0.202 would be relatively
unlikely if there were truly no change in mean number of hours worked
per week over this time period.</p>
<p>More exactly, we can calculate the p-value:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the p value from the test statistic and null distribution</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="va">null_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">observed_statistic</span>,</span>
<span>              direction <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_value</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">##   p_value</span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   0.028</span></span></code></pre>
<p>Thus, if the change in mean number of hours worked per week over this
time period were truly zero, our approximation of the probability that
we would see a test statistic as or more extreme than -0.202 is
approximately 0.028.</p>
<p>We can also generate a bootstrap confidence interval for the mean
paired difference using <code>type = "bootstrap"</code> in
<code><a href="../reference/generate.html">generate()</a></code>. As before, we use the pre-computed differences
when generating bootstrap resamples:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a bootstrap distribution</span></span>
<span><span class="va">boot_dist</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">gss_paired</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">diff</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="../reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"paired independence"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span>   </span>
<span><span class="fu"><a href="../reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">boot_dist</span><span class="op">)</span></span></code></pre></div>
<p><img src="paired_files/figure-html/generate-boot-1.png" width="576"></p>
<p>Note that, unlike the null distribution of test statistics generated
earlier with <code>type = "permute"</code>, this distribution is
centered at <code>observed_statistic</code>.</p>
<p>Calculating a confidence interval:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the confidence from the bootstrap distribution</span></span>
<span><span class="va">confidence_interval</span> <span class="op">&lt;-</span> <span class="va">boot_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_confidence_interval.html">get_confidence_interval</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span>
<span></span>
<span><span class="va">confidence_interval</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">##   lower_ci upper_ci</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   -<span style="color: #BB0000;">0.390</span>   -<span style="color: #BB0000;">0.022</span></span></span></code></pre>
<p>By default, <code><a href="../reference/get_confidence_interval.html">get_confidence_interval()</a></code> constructs the
lower and upper bounds by taking the observations at the <span class="math inline">\((1 - .95) / 2\)</span> and <span class="math inline">\(1 - ((1-.95) / 2)\)</span>th percentiles. To
instead build the confidence interval using the standard error of the
bootstrap distribution, we can write:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_dist</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/get_confidence_interval.html">get_confidence_interval</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"se"</span>,</span>
<span>                          point_estimate <span class="op">=</span> <span class="va">observed_statistic</span>,</span>
<span>                          level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">##   lower_ci upper_ci</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>   -<span style="color: #BB0000;">0.383</span>  -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">0</span></span></span></code></pre>
<p>To learn more about randomization-based inference for paired
observations, see the relevant chapter in <a href="https://openintro-ims.netlify.app/inference-paired-means.html" class="external-link">Introduction
to Modern Statistics</a>.</p>
</div>
  </main>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Andrew Bray, Chester Ismay, Evgeni Chasnovski, Simon Couch, Ben Baumer, Mine Cetinkaya-Rundel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer>
</body>
</html>
